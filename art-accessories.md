# Поиск товаров (`product_search`)

Эндпоинт для фильтрации и поиска товаров по каталогу с поддержкой пагинации, сортировки и множественных критериев отбора.

**URL:** `/api/products/search`

**Method:** `POST`

## Структура запроса

Тело запроса должно содержать два обязательных объекта корневого уровня:

* `filters` — объект с критериями поиска.
* `paginate` — настройки постраничного вывода.

---

## Объект `filters`

### Основной поиск и идентификация

| Параметр | Тип | Описание |
| :--- | :--- | :--- |
| `search_string` | `String` | Текстовый поисковый запрос (по названию или описанию). |
| `id` | `Number` | Поиск по точному ID товара. |
| `id_in` | `String` | Список ID товаров через запятую (например: `"10,25,33"`). |
| `product_slug` | `String` | Поиск по URL-slug товара. |

### Категории и группы

| Параметр | Тип | Описание |
| :--- | :--- | :--- |
| `categories` | `Array<ID>` | Массив ID категорий для фильтрации. |
| `product_group` | `Array<ID>` | Фильтр по группам товаров. |
| `is_related_for` | `ID` | Показать товары, являющиеся связанными для указанного `product_id`. |

### Цена

| Параметр | Тип | Описание |
| :--- | :--- | :--- |
| `price_from` | `Number` | Минимальная цена. |
| `price_to` | `Number` | Максимальная цена. |
| `price_currency` | `ID` | ID валюты для фильтрации цены. |
| `price_discount_from` | `Number` | Множитель скидки (от). |
| `price_discount_to` | `Number` | Множитель скидки (до). |
| `with_discount` | `Boolean*` | Показать только товары со скидкой (`true`/`false`/`unknown`). |

### Характеристики и габариты

| Параметр | Тип | Описание |
| :--- | :--- | :--- |
| `weight_from` / `_to` | `Number` | Диапазон веса. |
| `length_from` / `_to` | `Number` | Диапазон длины. |
| `width_from` / `_to` | `Number` | Диапазон ширины. |
| `height_from` / `_to` | `Number` | Диапазон высоты. |
| `weight_search_by` | `ID` | Единица измерения веса. |
| `length_search_by` | `ID` | Единица измерения длины/габаритов. |

### Рейтинг и отзывы

| Параметр | Тип | Описание |
| :--- | :--- | :--- |
| `avg_raiting_from` | `Number` | Средний рейтинг товара от. |
| `avg_raiting_to` | `Number` | Средний рейтинг товара до. |
| `c_aprooved_feedbacks_from`| `Number` | Количество подтвержденных отзывов (от). |
| `c_aprooved_feedbacks_to` | `Number` | Количество подтвержденных отзывов (до). |
| `owner_rating_from` | `Number` | Минимальный рейтинг продавца. |

### Флаги и статусы

Параметры принимают значения: `true`, `false` или `unknown` (не учитывать).

| Параметр | Описание |
| :--- | :--- |
| `only_featured` | Только рекомендуемые товары. |
| `only_new` | Только новинки. |
| `show_whishlist` | Только товары из вишлиста пользователя. |
| `subscription_exists`| Фильтрация по наличию подписки у пользователя. |

### Сортировка (`ordering`)

Принимает строковое значение из списка доступных вариантов. Знак `-` перед значением означает сортировку по убыванию.

| Значение | Описание |
| :--- | :--- |
| `popularity` / `-popularity` | По популярности. |
| `avg_raiting` / `-avg_raiting` | По среднему рейтингу. |
| `real_price_usd` / `-real_price_usd` | По реальной цене в USD. |
| `flag_is_new` / `-flag_is_new` | По новизне. |
| `flag_is_good_deal` / `-flag_is_good_deal`| По выгодности предложения. |

### Динамические варианты (Variants)

Поля для фильтрации по специфическим атрибутам (например, цвет, размер).

* `variant_1`, `variant_3`, `variant_4`, `variant_13`, `variant_24`, `variant_25`
* **Тип:** `Array<ID>`

---

## Объект `paginate`

Настройки постраничного вывода результатов.

| Параметр | Тип | Обязательно | Описание |
| :--- | :--- | :--- | :--- |
| `page` | `Number` | Нет | Номер страницы (по умолчанию `1`). |
| `pp_items` | `Number` | Нет | Количество элементов на странице (по умолчанию `15`). |
